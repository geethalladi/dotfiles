(when (window-system)
  ;; (set-default-font "Hasklig")
  (let ((alist
         '(
           (33 . ".\\(?:\\(?:==\\|!!\\)\\|[!=]\\)")
           (35 . ".\\(?:###\\|##\\|_(\\|[#(?[_{]\\)")
           (36 . ".\\(?:>\\)")
           (37 . ".\\(?:\\(?:%%\\)\\|%\\)")
           (38 . ".\\(?:\\(?:&&\\)\\|&\\)")
           (43 . ".\\(?:\\(?:\\+\\+\\)\\|[+>]\\)")
           (48 . ".\\(?:x[a-zA-Z]\\)")
           (58 . ".\\(?:::\\|[:=]\\)")
           (59 . ".\\(?:;;\\|;\\)")
           (60 . ".\\(?:\\(?:!--\\)\\|\\(?:~~\\|->\\|\\$>\\|\\*>\\|\\+>\\|--\\|<[<=-]\\|=[<=>]\\||>\\)\\|[*$+~/<=>|-]\\)")
           (61 . ".\\(?:\\(?:/=\\|:=\\|<<\\|=[=>]\\|>>\\)\\|[<=>~]\\)")
           (62 . ".\\(?:\\(?:=>\\|>[=>-]\\)\\|[=>-]\\)")
           (63 . ".\\(?:\\(\\?\\?\\)\\|[:=?]\\)")
           (91 . ".\\(?:]\\)")
           (92 . ".\\(?:\\(?:\\\\\\\\\\)\\|\\\\\\)")
           (94 . ".\\(?:=\\)")
           (119 . ".\\(?:ww\\)")
           (123 . ".\\(?:-\\)")
           (126 . ".\\(?:~>\\|~~\\|[>=@~-]\\)")

           ;;; Contentious Patterns :: Hangs my emacs

           ;; hangs in org-mode (distractions.org)
           ;; (42 . ".\\(?:\\(?:\\*\\*/\\)\\|\\(?:\\*[*/]\\)\\|[*/>]\\)")

           ;; hangs in ag search
           ;; (47 . ".\\(?:\\(?:\\*\\*\\|//\\|==\\)\\|[*/=>]\\)")

           (45 . ".\\(?:\\(?:-[>-]\\|<<\\|>>\\)\\|[<>}~-]\\)")
           (46 . ".\\(?:\\(?:\\.[.<]\\)\\|[.=-]\\)")
           (124 . ".\\(?:\\(?:|[=|]\\)\\|[=>|]\\)"))))
    (dolist (char-regexp alist)
      (set-char-table-range composition-function-table (car char-regexp)
                            `([,(cdr char-regexp) 0 font-shape-gstring])))))
